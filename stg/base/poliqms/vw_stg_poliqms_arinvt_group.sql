with src as (
    select 
        *   
         ,'{{source('poliqms','arinvt_group')}}' as etl_src_table_name
         ,'POLIQMS'                              as source_system
    from {{source('poliqms','arinvt_group')}}
)
,deduped as (
    select
        *,
        row_number() over (partition by id order by _rivery_last_update desc) row_nbr
    from src
)
select
	id,
	code,
	descrip,
	eplant_id,
	class,
	cycle_count_id,
	fr_wo_time_fence,
	intrastat_code,
	unque_date_in,
	is_lot_mandatory,
	is_lot_date_mandatory,
	coc_exclude,
	web_salable,
	is_linked_to_serial,
	fr_include,
	keep_label_bom_interplant_tran,
	rfq_use_std_cost,
	nontaxable,
	cuser1,
	cuser2,
	cuser3,
	cuser4,
	cuser5,
	cuser6,
	cuser7,
	cuser8,
	cuser9,
	cuser10,
	nuser1,
	nuser2,
	nuser3,
	nuser4,
	nuser5,
	nuser6,
	nuser7,
	nuser8,
	nuser9,
	nuser10,
	acct_id_cogs,
	acct_id_fg,
	acct_id_holding,
	acct_id_invshrink,
	acct_id_labor_dispo,
	acct_id_oh_dispo,
	acct_id_ppv,
	acct_id_prod_variance,
	acct_id_sales,
	acct_id_shipping,
	acct_id_wip,
	acct_id_prodvar,
	acct_id_scrap,
	acct_id_inv_cost_rev,
	acct_id_intplant_sales,
	acct_id_phys_inv_var,
	acct_id_rma_cr_memo,
	acct_id_rma_inv,
	unique_dispo_loc,
	excl_mark_wo_mat_xcpt,
	auto_pop_serv_ctr,
	do_not_dispo_floor_partial,
	max_pallet_stack,
	loose_inv_move_class_id,
	pack_inv_move_class_id,
	pallet_inv_move_class_id,
	excl_workorder_mat,
	fifo,
	is_drop_ship,
	msds_authorable,
	nontaxable_po,
	is_pallet,
	excl_from_ctp_exception,
	tax_class_id,
	gl_plug_value,
	acct_id_intransit,
	acct_id_ip_trans,
	acct_id_ip_trans_var,
	acct_id_inv_rounding,
	acct_id_pallet_charge,
	_rivery_river_id,
	_rivery_run_id,
	_rivery_last_update,
    etl_src_table_name,
    source_system
from deduped
where row_nbr = 1