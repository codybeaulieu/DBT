with src as (
    select 
        *   
         ,'{{source('poliqms','arinvt')}}' as etl_src_table_name
         ,'POLIQMS'                        as source_system
    from {{source('poliqms','arinvt')}}
)
,deduped as (
    select
        *,
        row_number() over (partition by id order by _rivery_last_update desc) row_nbr
    from src
)
select
	id,
	arcusto_id,
	class,
	itemno,
	rev,
	descrip,
	descrip2,
	avg_cost,
	vendor_id,
	unit,
	blend,
	cuser1,
	cuser2,
	cuser3,
	nuser1,
	nuser2,
	nuser3,
	bom_active,
	onhand,
	rg_onhand,
	non_salable,
	non_conform_total,
	serialized,
	safety_stock,
	min_order_qty,
	max_order_qty,
	multiple,
	ytdqty,
	ptdqty,
	code,
	ldate,
	lbuy_date,
	type,
	series,
	lead_days,
	lead_time,
	spg,
	drytime,
	drytemp,
	rgprcnt,
	auto_mjo,
	mfg_quan,
	aux_amt,
	stdquan,
	low_level_code,
	mps_code,
	arinvt_family_id,
	backflush,
	drawing,
	ecno,
	std_price,
	std_cost,
	standard_id,
	acct_id_sales,
	acct_id_inv,
	mfg_split,
	price_per_1000,
	comis_prcnt,
	unque_date_in,
	shelf_life,
	ecode,
	eid,
	edate_time,
	ecopy,
	acct_id_ppv,
	acct_id_oh_dispo,
	acct_id_labor_dispo,
	acct_id_holding,
	item_type_id,
	nmfc_id,
	volume,
	auto_mrp_reord_point,
	auto_mrp_order_qty,
	auto_mrp_lead_days,
	eplant_id,
	commissions_id,
	std_cost_control,
	po_scope,
	po_safety,
	po_move_range,
	lm_image_filename,
	cycle_count_code,
	cuser4,
	cuser5,
	cuser6,
	cuser7,
	cuser8,
	cuser9,
	cuser10,
	nuser4,
	nuser5,
	nuser6,
	nuser7,
	nuser8,
	nuser9,
	nuser10,
	process_safety_stock,
	mx_group_id,
	fr_group_id,
	setup_charge,
	move_time,
	cartons_pallet,
	pieces_carton,
	auto_mrp_firm_wo,
	floor_backflush,
	mps,
	cum_leadtime,
	phantom,
	critical_fence,
	user_name,
	pk_hide,
	acct_id_prodvar,
	phantom_onhand,
	lm_labels_id,
	drive_phantom_negative,
	no_stdcost_recalc,
	acct_id_intplant_sales,
	image_filename,
	non_allocate_total,
	insp_receipt_thres,
	insp_receipt_count,
	cost_standard_id_future,
	cost_standard_id,
	cost_descrip_future,
	cost_descrip,
	cost_calc_date_future,
	cost_calc_date,
	auto_mrp_include_vmi,
	prod_code_id,
	do_not_dispo_floor_partial,
	info_so,
	info_po,
	excl_receipt_time_ppv,
	cycle_count_id,
	cycle_count_date,
	non_material,
	mfg_min_qty,
	mfg_multiple,
	buyer_code_id,
	cost_calc_batch,
	intrastat_code,
	fab_start,
	mfg_safety_qty,
	planner_code_id,
	is_lot_mandatory,
	pk_weight,
	pk_ptsper,
	do_not_sched_forecast_wo,
	is_pallet,
	is_auto_rt_labels,
	is_linked_to_serial,
	fr_include,
	min_cpk,
	lbl_assist_last_print,
	lbl_assist_print_interval,
	coc_exclude,
	ict_reord_point,
	ict_replenish_scope_days,
	ict_lead_days,
	ict_ship_to_id,
	auto_mrp_kanban_lot_size,
	ict_fire_trigger,
	color_group_id,
	fr_wo_time_fence,
	pk_length,
	pk_width,
	pk_height,
	pallet_length,
	pallet_width,
	pallet_height,
	pallet_volume,
	pallet_ptsper,
	pallet_weight,
	length,
	width,
	gauge,
	is_by_product,
	exclude_from_commissions,
	auto_rt_labels_pk_seq,
	pallet_pattern_id,
	web_salable,
	po_multiple,
	fifo_threshold,
	cost_standard_id_forecast,
	cost_standard_id_budget,
	cost_descrip_forecast,
	cost_descrip_budget,
	cost_calc_date_forecast,
	cost_calc_date_budget,
	keep_label_bom_interplant_tran,
	eco_orig_class,
	acct_id_wip,
	irv32_no_plan_wo,
	info_rec,
	is_lot_date_mandatory,
	use_this_uom_for_mrp,
	wait_time,
	bol_calc_override,
	rfq_use_std_cost,
	acct_id_phys_var,
	acct_id_inv_cost_rev,
	exclude_backflush,
	nontaxable,
	acct_id_shipment,
	auto_mrp_exclude_hard_alloc,
	min_ppk,
	run_rules,
	rtpm_trg_rtlabel,
	rebate_params_id,
	tariff_code_id,
	webdirect_lead_days,
	use_cost_default_standard_id,
	arinvt_group_id,
	cloned_from_arinvt_id,
	use_lot_charge,
	lot_charge,
	unique_dispo_loc,
	heijunka_since_sched_demand,
	config_code,
	auto_mrp_include_vmi_mfg_calc,
	fr_wo_scope,
	auto_mrp_apply_to_sched_alloc,
	phantom_components_on_so,
	sched_cascade_parent_mto,
	auto_pop_serv_ctr,
	excl_mark_wo_mat_xcpt,
	is_alc,
	mark_ord_detail_mto,
	msds_authorable,
	is_msds,
	msds_upload,
	nontaxable_po,
	override_rec_loc,
	lbl_last_print,
	is_drop_ship,
	max_pallet_stack,
	loose_inv_move_class_id,
	pack_inv_move_class_id,
	pallet_inv_move_class_id,
	pk_unit_type,
	loose_move_rank_count,
	pack_move_rank_count,
	pallet_move_rank_count,
	excl_workorder_mat,
	fifo,
	company_id,
	recv_location_id,
	spc_inspection_id,
	ar_discount_waterfall_id,
	wms_inv_group_id,
	loose_move_rank_lock,
	pack_move_rank_lock,
	pallet_move_rank_lock,
	loose_weight,
	loose_volume,
	loose_length,
	loose_width,
	loose_height,
	excl_from_ctp_exception,
	core_size,
	od,
	ps_convert_info,
	cycle_count_rank_lock,
	min_sell_qty,
	insp_lead_days,
	is_lot_expiry_date_mandatory,
	ict_truck_ptsper,
	safety_stock2,
	arinvt_recipe_id,
	cost_calc_user_name,
	shelf_life2,
	ict_auto_mrp_order_qty,
	ict_ship_pull_demand,
	plt_wrp_use_qc,
	plt_wrp_loc_id,
	hard_alloc_round_precision,
	backflush_by_serial,
	group_code,
	proprietary_effect_date,
	proprietary_deactive_date,
	demand_change,
	tax_class_id,
	discount_groups_id,
	phys_char_volume,
	phantom_kit_use_comp_price,
	assy1_exclude_forecast_wo,
	last_demand_change,
	gl_plug_value,
	carousel_target_id,
	carousel_operator,
	created,
	createdby,
	changed,
	changedby,
	acct_id_intransit,
	acct_id_ip_trans,
	acct_id_ip_trans_var,
	acct_id_inv_rounding,
	directed_task_auto_gen,
	auto_mrp_scope_days,
	acct_id_pallet_charge,
	_rivery_river_id,
	_rivery_run_id,
	_rivery_last_update,
    etl_src_table_name,
    source_system
from deduped
where row_nbr = 1